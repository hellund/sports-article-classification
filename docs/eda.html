<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Clustering" href="clustering.html" /><link rel="prev" title="Readme File" href="readme_link.html" />

    <!-- Generated with Sphinx 5.0.2 and Furo 2022.12.07 -->
        <title>EDA - sports-article-classification 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">sports-article-classification 0.0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">sports-article-classification 0.0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="readme_link.html">README</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DATA:</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">EDA</a></li>
<li class="toctree-l1"><a class="reference internal" href="clustering.html">CLUSTERING</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Methods:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="utils.html">UTILS</a></li>
<li class="toctree-l1"><a class="reference internal" href="sofus_alert.html">SOFUS ALERT</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_scraper.html">DATA SCRAPER</a></li>
<li class="toctree-l1"><a class="reference internal" href="nordskog_data.html">NORDSKOG DATA</a></li>
<li class="toctree-l1"><a class="reference internal" href="preprocessing.html">PREPROCESSING</a></li>
<li class="toctree-l1"><a class="reference internal" href="active_learning_data.html">ACTIVE LEARNING DATA</a></li>
<li class="toctree-l1"><a class="reference internal" href="active_learning.html">ACTIVE LEARNING</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="eda">
<h1>EDA<a class="headerlink" href="#eda" title="Permalink to this heading">#</a></h1>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this heading">#</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.figure_factory</span> <span class="k">as</span> <span class="nn">ff</span>
<span class="kn">import</span> <span class="nn">nltk</span>
<span class="kn">from</span> <span class="nn">nltk.tokenize</span> <span class="kn">import</span> <span class="n">sent_tokenize</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
<span class="kn">from</span> <span class="nn">nltk.probability</span> <span class="kn">import</span> <span class="n">FreqDist</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">src.data.nordskog_data</span> <span class="kn">import</span> <span class="n">get_data</span>
<span class="kn">from</span> <span class="nn">src.data.preprocessing</span> <span class="kn">import</span> <span class="n">DataPreprocessor</span>
</pre></div>
</div>
</section>
<section id="loading-data">
<h2>Loading data<a class="headerlink" href="#loading-data" title="Permalink to this heading">#</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="about-the-data">
<h2>About the data<a class="headerlink" href="#about-the-data" title="Permalink to this heading">#</a></h2>
<p>The data is a collection of fotball articles collected by Aanund
Nordskog from VG and TV2, divided into paragraphs. The training data was
retrieved form articles published between 22.07.18 and 17.09.18. The
testing data is from articles between 14.12.19. Not that the the
different time periods may affect the kind of articles published in the
different periods. Each paragraph is labeled as following:</p>
<ul><li><p>Goal/Assist</p>
</li><li><p>Quotes</p>
</li><li><p>Transfer</p>
</li><li><p>Irrelevant</p>
</li><li><p>Ignore</p>
</li><li><p>Player Detail</p>
</li><li><p>Club Detail</p>
</li><li><p>Chances</p>
</li></ul><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Printing the dimension of the data</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of training paragraphs:</span><span class="si">{</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of testing paragraphs: </span><span class="si">{</span><span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Number</span> <span class="n">of</span> <span class="n">training</span> <span class="n">paragraphs</span><span class="p">:(</span><span class="mi">5526</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">testing</span> <span class="n">paragraphs</span><span class="p">:</span> <span class="p">(</span><span class="mi">611</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Displaying the first rows of training data</span>
<span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Vålerenga - Rosenborg 2-3</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sam Johnson ga vertene ledelsen, men Jonathan ...</td>
      <td>Goal/Assist</td>
    </tr>
    <tr>
      <th>2</th>
      <td>På et hjørnespark langt på overtid kom avgjøre...</td>
      <td>Goal/Assist</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ti minutter før pause scoret Sam Johnson sitt ...</td>
      <td>Goal/Assist</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Vålerenga holdt 1-0-ledelsen bare frem til sis...</td>
      <td>Goal/Assist</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Se Manchester City-Chelsea søndag fra 16.30 (k...</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Chelsea har en lang tradisjon for å hente stje...</td>
      <td>Irrelevant</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Spillere som Andrij Sjevtsjenko, Fernando Torr...</td>
      <td>Irrelevant</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Blant alle skuffelsene har det likevel vært ly...</td>
      <td>Irrelevant</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Det er denne rekken Higuaín nå håper å føye se...</td>
      <td>Irrelevant</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Displaying info</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Training data:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Testing data:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Training data:
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 5526 entries, 0 to 5525
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype
---  ------  --------------  -----
 0   text    5526 non-null   object
 1   label   5526 non-null   object
dtypes: object(2)
memory usage: 86.5+ KB
None

Testing data:
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 611 entries, 0 to 610
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype
---  ------  --------------  -----
 0   text    611 non-null    object
 1   label   611 non-null    object
dtypes: object(2)
memory usage: 9.7+ KB
None
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display statistical information for categorical variables</span>
<span class="n">train</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5526</td>
      <td>5526</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>5436</td>
      <td>12</td>
    </tr>
    <tr>
      <th>top</th>
      <td>Tipster gir deg ferske oddstips hver dag!</td>
      <td>Goal/Assist</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>11</td>
      <td>1117</td>
    </tr>
  </tbody>
</table>
</div><p>There are 90 paragraphs that are not unique, with “Tipster gir deg…”
being the most frequent.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>83</th>
      <td>Se målene i Sportsnyhetene øverst!\n</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>378</th>
      <td>Se målene i Sportsnyhetene øverst!\n</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>840</th>
      <td>Tipster gir deg ferske oddstips hver dag!</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>846</th>
      <td>Tipster gir deg ferske oddstips hver dag!</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>847</th>
      <td>• Her er fredagens oddstips</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5376</th>
      <td>Se generaltabben i videovinduet øverst.</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>5383</th>
      <td>Se Leicester mot Liverpool på TV 2 Sport Premi...</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>5387</th>
      <td>Se Europaligaen på TV 2 Sumo og TV 2s kanaler!\n</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>5398</th>
      <td>VG Live: Følg Norge-Nederland kl. 17.00</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>5400</th>
      <td>Norge-Kypros ser du på TV 2 eller følger på V...</td>
      <td>Ignore</td>
    </tr>
  </tbody>
</table>
<p>90 rows × 2 columns</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display statistical information for categorical variables</span>
<span class="n">test</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>611</td>
      <td>611</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>609</td>
      <td>5</td>
    </tr>
    <tr>
      <th>top</th>
      <td>– Selvfølgelig vil jeg tilbake til Madrid og s...</td>
      <td>Irrelevant</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>2</td>
      <td>293</td>
    </tr>
  </tbody>
</table>
</div><p>There are at least two duplicate paragraphs in the testing data</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>290</th>
      <td>– Selvfølgelig vil jeg tilbake til Madrid og s...</td>
      <td>Quote</td>
    </tr>
    <tr>
      <th>588</th>
      <td>– Jeg har mange drømmer, også her i Vitesse. Å...</td>
      <td>Quote</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Goal</span><span class="o">/</span><span class="n">Assist</span>       <span class="mi">1117</span>
<span class="n">quote</span>              <span class="mi">975</span>
<span class="n">Transfer</span>           <span class="mi">887</span>
<span class="n">irrelevant</span>         <span class="mi">812</span>
<span class="n">Ignore</span>             <span class="mi">663</span>
<span class="n">Player</span> <span class="n">details</span>     <span class="mi">340</span>
<span class="n">Club</span> <span class="n">details</span>       <span class="mi">315</span>
<span class="n">sjanse</span>             <span class="mi">300</span>
<span class="n">Injuries</span>            <span class="mi">59</span>
<span class="n">Rodt</span><span class="o">/</span><span class="n">gult</span> <span class="n">kort</span>      <span class="mi">50</span>
<span class="n">Club</span> <span class="n">drama</span>           <span class="mi">5</span>
<span class="n">Personal</span> <span class="n">drama</span>       <span class="mi">3</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">label</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Irrelevant</span>     <span class="mi">293</span>
<span class="n">Quote</span>          <span class="mi">141</span>
<span class="n">Goal</span><span class="o">/</span><span class="n">Assist</span>     <span class="mi">69</span>
<span class="n">Transfer</span>        <span class="mi">60</span>
<span class="n">Ignore</span>          <span class="mi">48</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">label</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
</section>
<section id="data-preprocessing">
<h2>Data preprocessing<a class="headerlink" href="#data-preprocessing" title="Permalink to this heading">#</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">processed_train</span> <span class="o">=</span> <span class="n">DataPreprocessor</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">processed_train</span><span class="o">.</span><span class="n">map_nordskog_data</span><span class="p">()</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">processed_train</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;num_char&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;num_words&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;num_sent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">sent_tokenize</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;avg_word_len&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()]))</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;avg_sent_len&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">sent_tokenize</span><span class="p">(</span><span class="n">x</span><span class="p">)]))</span>
<span class="n">train</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
      <th>num_char</th>
      <th>num_words</th>
      <th>num_sent</th>
      <th>avg_word_len</th>
      <th>avg_sent_len</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Vålerenga - Rosenborg 2-3</td>
      <td>Ignore</td>
      <td>25</td>
      <td>4</td>
      <td>1</td>
      <td>5.500000</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sam Johnson ga vertene ledelsen, men Jonathan ...</td>
      <td>Goal/Assist</td>
      <td>187</td>
      <td>31</td>
      <td>2</td>
      <td>5.064516</td>
      <td>15.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>På et hjørnespark langt på overtid kom avgjøre...</td>
      <td>Goal/Assist</td>
      <td>134</td>
      <td>20</td>
      <td>1</td>
      <td>5.750000</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ti minutter før pause scoret Sam Johnson sitt ...</td>
      <td>Goal/Assist</td>
      <td>166</td>
      <td>31</td>
      <td>1</td>
      <td>4.387097</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Vålerenga holdt 1-0-ledelsen bare frem til sis...</td>
      <td>Goal/Assist</td>
      <td>203</td>
      <td>29</td>
      <td>2</td>
      <td>6.034483</td>
      <td>14.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5521</th>
      <td>– Mateo har sagt at han ønsker å dra. Jeg vil ...</td>
      <td>Quote</td>
      <td>152</td>
      <td>29</td>
      <td>2</td>
      <td>4.275862</td>
      <td>14.5</td>
    </tr>
    <tr>
      <th>5522</th>
      <td>– Her gjør han en miss. Han står midt i mål, o...</td>
      <td>Quote</td>
      <td>242</td>
      <td>46</td>
      <td>4</td>
      <td>4.282609</td>
      <td>11.5</td>
    </tr>
    <tr>
      <th>5523</th>
      <td>– Vi kan ta med masse positivt fra kampen, for...</td>
      <td>Quote</td>
      <td>213</td>
      <td>42</td>
      <td>2</td>
      <td>4.095238</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>5524</th>
      <td>Den tyske midtbanespilleren kom til Bayern Mün...</td>
      <td>Player Detail</td>
      <td>327</td>
      <td>53</td>
      <td>2</td>
      <td>4.735849</td>
      <td>26.5</td>
    </tr>
    <tr>
      <th>5525</th>
      <td>Bendtner har vært i norsk fotball siden mars 2...</td>
      <td>Player Detail</td>
      <td>170</td>
      <td>29</td>
      <td>2</td>
      <td>4.896552</td>
      <td>14.5</td>
    </tr>
  </tbody>
</table>
<p>5526 rows × 7 columns</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">)),</span>
             <span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span>
             <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Labels&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="s1">&#39;Amount of paragraphs&#39;</span><span class="p">},</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sum of paragraphs per label in training data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/output_21_1.png" src="_images/output_21_1.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">sum_words</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;num_words&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">)),</span>
             <span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sum_words&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span>
             <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Labels&#39;</span><span class="p">,</span> <span class="s1">&#39;sum_words&#39;</span><span class="p">:</span> <span class="s1">&#39;Amount of words&#39;</span><span class="p">},</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sum of words per label in training data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/output_22_0.png" src="_images/output_22_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">sum_char</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;num_char&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">)),</span>
             <span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sum_char&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span>
             <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Labels&#39;</span><span class="p">,</span> <span class="s1">&#39;sum_char&#39;</span><span class="p">:</span> <span class="s1">&#39;Amount of characters&#39;</span><span class="p">},</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sum of characters per label in training data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/output_23_0.png" src="_images/output_23_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">sum_sent</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;num_sent&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">)),</span>
             <span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sum_sent&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span>
             <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Labels&#39;</span><span class="p">,</span> <span class="s1">&#39;sum_sent&#39;</span><span class="p">:</span> <span class="s1">&#39;Amount of characters&#39;</span><span class="p">},</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sum of sentences per label in training data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/output_24_0.png" src="_images/output_24_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plots</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

<span class="k">for</span> <span class="n">plot</span> <span class="ow">in</span> <span class="n">plots</span><span class="p">:</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">create_distplot</span><span class="p">([</span><span class="n">train</span><span class="p">[</span><span class="n">plot</span><span class="p">]],</span> <span class="p">[</span><span class="n">plot</span><span class="p">],</span> <span class="n">curve_type</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/output_25_0.png" src="_images/output_25_0.png" />
<img alt="_images/output_25_1.png" src="_images/output_25_1.png" />
<img alt="_images/output_25_2.png" src="_images/output_25_2.png" />
<img alt="_images/output_25_3.png" src="_images/output_25_3.png" />
<img alt="_images/output_25_4.png" src="_images/output_25_4.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">processed_train</span><span class="o">.</span><span class="n">remove_extra_spaces_from_text</span><span class="p">()</span>
<span class="n">processed_train</span><span class="o">.</span><span class="n">remove_paragraphs_over_65_words</span><span class="p">()</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">processed_train</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;norwegian&#39;</span><span class="p">))</span>
<span class="n">corpus</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">i</span> <span class="k">if</span> <span class="p">(</span><span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stop</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">most_frequent</span> <span class="o">=</span> <span class="n">FreqDist</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">most_frequent</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;–&#39;</span><span class="p">,</span> <span class="mi">1173</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;Det&#39;</span><span class="p">,</span> <span class="mi">830</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;fikk&#39;</span><span class="p">,</span> <span class="mi">496</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;ballen&#39;</span><span class="p">,</span> <span class="mi">476</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;minutter&#39;</span><span class="p">,</span> <span class="mi">469</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;sier&#39;</span><span class="p">,</span> <span class="mi">434</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;TV&#39;</span><span class="p">,</span> <span class="mi">423</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;Han&#39;</span><span class="p">,</span> <span class="mi">395</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;første&#39;</span><span class="p">,</span> <span class="mi">391</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="mi">377</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">words</span><span class="p">,</span> <span class="n">frequency</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">most_frequent</span><span class="p">:</span>
    <span class="n">words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="n">frequency</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">frequency</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">words</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">autorange</span><span class="o">=</span><span class="s2">&quot;reversed&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/output_29_0.png" src="_images/output_29_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vec</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">stop_words</span> <span class="o">=</span> <span class="n">stop</span><span class="p">,</span> <span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">bow</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
<span class="n">count_values</span> <span class="o">=</span> <span class="n">bow</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ngram_freq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">sorted</span><span class="p">([(</span><span class="n">count_values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vec</span><span class="o">.</span><span class="n">vocabulary_</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span> <span class="n">reverse</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<span class="n">ngram_freq</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;frequency&quot;</span><span class="p">,</span> <span class="s2">&quot;ngram&quot;</span><span class="p">]</span>
<span class="n">ngram_freq</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>frequency</th>
      <th>ngram</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>236</td>
      <td>premier league</td>
    </tr>
    <tr>
      <th>1</th>
      <td>153</td>
      <td>manchester united</td>
    </tr>
    <tr>
      <th>2</th>
      <td>142</td>
      <td>real madrid</td>
    </tr>
    <tr>
      <th>3</th>
      <td>118</td>
      <td>tv 2s</td>
    </tr>
    <tr>
      <th>4</th>
      <td>112</td>
      <td>millioner kroner</td>
    </tr>
    <tr>
      <th>5</th>
      <td>85</td>
      <td>tv sport</td>
    </tr>
    <tr>
      <th>6</th>
      <td>77</td>
      <td>sport premium</td>
    </tr>
    <tr>
      <th>7</th>
      <td>77</td>
      <td>minutter senere</td>
    </tr>
    <tr>
      <th>8</th>
      <td>75</td>
      <td>manchester city</td>
    </tr>
    <tr>
      <th>9</th>
      <td>68</td>
      <td>tv sumo</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vec</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">stop_words</span> <span class="o">=</span> <span class="n">stop</span><span class="p">,</span> <span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">bow</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
<span class="n">count_values</span> <span class="o">=</span> <span class="n">bow</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ngram_freq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">sorted</span><span class="p">([(</span><span class="n">count_values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vec</span><span class="o">.</span><span class="n">vocabulary_</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span> <span class="n">reverse</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<span class="n">ngram_freq</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;frequency&quot;</span><span class="p">,</span> <span class="s2">&quot;ngram&quot;</span><span class="p">]</span>
<span class="n">ngram_freq</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>frequency</th>
      <th>ngram</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>77</td>
      <td>tv sport premium</td>
    </tr>
    <tr>
      <th>1</th>
      <td>34</td>
      <td>erling braut håland</td>
    </tr>
    <tr>
      <th>2</th>
      <td>32</td>
      <td>tv 2s fotballekspert</td>
    </tr>
    <tr>
      <th>3</th>
      <td>32</td>
      <td>sier tv 2s</td>
    </tr>
    <tr>
      <th>4</th>
      <td>32</td>
      <td>minutter full tid</td>
    </tr>
    <tr>
      <th>5</th>
      <td>31</td>
      <td>sport premium sumo</td>
    </tr>
    <tr>
      <th>6</th>
      <td>27</td>
      <td>tv sumo tv</td>
    </tr>
    <tr>
      <th>7</th>
      <td>26</td>
      <td>2s premier league</td>
    </tr>
    <tr>
      <th>8</th>
      <td>25</td>
      <td>tv 2s premier</td>
    </tr>
    <tr>
      <th>9</th>
      <td>25</td>
      <td>premium tv sumo</td>
    </tr>
  </tbody>
</table>
</div></section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="clustering.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Clustering</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="readme_link.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Readme File</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Eirik Helland
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">EDA</a><ul>
<li><a class="reference internal" href="#imports">Imports</a></li>
<li><a class="reference internal" href="#loading-data">Loading data</a></li>
<li><a class="reference internal" href="#about-the-data">About the data</a></li>
<li><a class="reference internal" href="#data-preprocessing">Data preprocessing</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    </body>
</html>