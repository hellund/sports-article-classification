<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Clustering" href="clustering.html" /><link rel="prev" title="EDA" href="eda.html" />

    <!-- Generated with Sphinx 5.0.2 and Furo 2022.12.07 -->
        <title>EDA v2 - sports-article-classification 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">sports-article-classification 0.0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">sports-article-classification 0.0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="readme_link.html">Readme File</a></li>
<li class="toctree-l1"><a class="reference internal" href="readme_link.html#sports-article-classification">sports-article-classification</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DATA:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="eda.html">EDA</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">EDA v2</a></li>
<li class="toctree-l1"><a class="reference internal" href="clustering.html">CLUSTERING</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">MODELS:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="multi_label_bert_model.html">MULTI-LABEL BERT</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Methods:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="utils.html">UTILS</a></li>
<li class="toctree-l1"><a class="reference internal" href="sofus_alert.html">SOFUS ALERT</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_scraper.html">DATA SCRAPER</a></li>
<li class="toctree-l1"><a class="reference internal" href="nordskog_data.html">NORDSKOG DATA</a></li>
<li class="toctree-l1"><a class="reference internal" href="preprocessing.html">PREPROCESSING</a></li>
<li class="toctree-l1"><a class="reference internal" href="active_learning_data.html">ACTIVE LEARNING DATA</a></li>
<li class="toctree-l1"><a class="reference internal" href="active_learning.html">ACTIVE LEARNING</a></li>
<li class="toctree-l1"><a class="reference internal" href="doccano.html">DOCCANO</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="eda-v2">
<h1>EDA v2<a class="headerlink" href="#eda-v2" title="Permalink to this heading">#</a></h1>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this heading">#</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.figure_factory</span> <span class="k">as</span> <span class="nn">ff</span>
<span class="kn">import</span> <span class="nn">nltk</span>
<span class="kn">from</span> <span class="nn">nltk.tokenize</span> <span class="kn">import</span> <span class="n">sent_tokenize</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
<span class="kn">from</span> <span class="nn">nltk.probability</span> <span class="kn">import</span> <span class="n">FreqDist</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">src.data.nordskog_data</span> <span class="kn">import</span> <span class="n">get_data</span>
<span class="kn">from</span> <span class="nn">src.data.preprocessing</span> <span class="kn">import</span> <span class="n">DataPreprocessorNordskog</span><span class="p">,</span> <span class="n">DataPreprocessorHelland</span>

<span class="kn">from</span> <span class="nn">src.annotation.doccano</span> <span class="kn">import</span> <span class="n">get_latest_annotated_data</span>
</pre></div>
</div>
</section>
<section id="loading-data">
<h2>Loading data<a class="headerlink" href="#loading-data" title="Permalink to this heading">#</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">()</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">get_latest_annotated_data</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Unnamed: 2&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="about-the-data">
<h2>About the data<a class="headerlink" href="#about-the-data" title="Permalink to this heading">#</a></h2>
<p>The data used for my master thesis is based on two datasets. The first
and orignal dataset was collected by Aanund Nordskog and was the
inspiration for the thesis and the further collection of my own
supplementary dataset. The new dataset is meant to tackle and solve
apperent problems with the first dataset, and give the task of
classifying paragraphs from football articles a new and more complete
approach.</p>
<p>The original data is a collection of fotball articles collected by
Aanund Nordskog from VG and TV2, divided into paragraphs. The training
data was retrieved form articles published between 22.07.18 and
17.09.18. The testing data is from articles between 14.12.19. Not that
the the different time periods may affect the kind of articles published
in the different periods. Each paragraph is labeled as following:</p>
<ul><li><p>Goal/Assist</p>
</li><li><p>Quotes</p>
</li><li><p>Transfer</p>
</li><li><p>Irrelevant</p>
</li><li><p>Ignore</p>
</li><li><p>Player Detail</p>
</li><li><p>Club Detail</p>
</li><li><p>Chances</p>
</li></ul><p>The new data, collected by Eirik Helland, is paragraphs from football
articles at VG.no in the preiod between 01.01.2022 and 01.01.2023. The
total data collected is 10147 paragraphs, and of these paragraphs, 2000
have been annotated. The paragraphs have been annotated in a random
order to prevent the seasonal football events to be to prevelant in the
data. This is important becuase some events only occur in the start or
end of a season or every other season, such as transfer windows and
international cups. The data have been annotated with multiple labels,
making the task multi-label classification instead of multi-class
classification as in the case of Nordskog’s dataset. The possible labels
are as follows:</p>
<ul><li><p>Booking</p>
</li><li><p>Chance</p>
</li><li><p>Commentary</p>
</li><li><p>Description</p>
</li><li><p>Garbage</p>
</li><li><p>Goal</p>
</li><li><p>Injury</p>
</li><li><p>Link</p>
</li><li><p>Next game</p>
</li><li><p>Odds</p>
</li><li><p>Opinion</p>
</li><li><p>Quote</p>
</li><li><p>Rumour</p>
</li><li><p>Set-piece</p>
</li><li><p>Statement</p>
</li><li><p>Statistics</p>
</li><li><p>Storytelling</p>
</li><li><p>Substitution</p>
</li><li><p>Summary</p>
</li><li><p>Table</p>
</li><li><p>Transfer</p>
</li><li><p>VAR</p>
</li></ul><p>There are a total off 22 different labels. The labels are split into
different levels of type of information. The different levels are
Paragraph type, Communication type, Paragraph content and Paragraph
action. None of the labels are mutually exclusive because of the
paragraphs sometimes containing multiple levels of information. Patterns
will occur as the style by the writers at VG.no probably is guided by
shared guidelines.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Printing the dimension of the data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Nordskogs&#39;s data:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of training paragraphs:</span><span class="si">{</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of testing paragraphs: </span><span class="si">{</span><span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Multi-label data:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of testing paragraphs: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Nordskogs</span><span class="s1">&#39;s data:</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">training</span> <span class="n">paragraphs</span><span class="p">:(</span><span class="mi">5526</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">testing</span> <span class="n">paragraphs</span><span class="p">:</span> <span class="p">(</span><span class="mi">611</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">Multi</span><span class="o">-</span><span class="n">label</span> <span class="n">data</span><span class="p">:</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">testing</span> <span class="n">paragraphs</span><span class="p">:</span> <span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Displaying the first rows of training data</span>
<span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Vålerenga - Rosenborg 2-3</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sam Johnson ga vertene ledelsen, men Jonathan ...</td>
      <td>Goal/Assist</td>
    </tr>
    <tr>
      <th>2</th>
      <td>På et hjørnespark langt på overtid kom avgjøre...</td>
      <td>Goal/Assist</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ti minutter før pause scoret Sam Johnson sitt ...</td>
      <td>Goal/Assist</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Vålerenga holdt 1-0-ledelsen bare frem til sis...</td>
      <td>Goal/Assist</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Se Manchester City-Chelsea søndag fra 16.30 (k...</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Chelsea har en lang tradisjon for å hente stje...</td>
      <td>Irrelevant</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Spillere som Andrij Sjevtsjenko, Fernando Torr...</td>
      <td>Irrelevant</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Blant alle skuffelsene har det likevel vært ly...</td>
      <td>Irrelevant</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Det er denne rekken Higuaín nå håper å føye se...</td>
      <td>Irrelevant</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Premier League valgte å offentliggjøre tre fly...</td>
      <td>[Link]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Romelu Lukaku har uttalt at han er misfornøyd ...</td>
      <td>[Opinion, Statement]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>– La oss være ærlige. Jeg liker det ikke, for ...</td>
      <td>[Quote]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Manchester United har fått mye kritikk etter å...</td>
      <td>[Commentary]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Her er torsdagens oddstips!</td>
      <td>[Garbage, Link, Odds]</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Displaying info</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Training data:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Testing data:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Multi-label data:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Training data:
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 5526 entries, 0 to 5525
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype
---  ------  --------------  -----
 0   text    5526 non-null   object
 1   label   5526 non-null   object
dtypes: object(2)
memory usage: 86.5+ KB
None

Testing data:
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 611 entries, 0 to 610
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype
---  ------  --------------  -----
 0   text    611 non-null    object
 1   label   611 non-null    object
dtypes: object(2)
memory usage: 9.7+ KB
None

Multi-label data:
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 2005 entries, 0 to 2004
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype
---  ------  --------------  -----
 0   text    2005 non-null   object
 1   label   2002 non-null   object
dtypes: object(2)
memory usage: 31.5+ KB
None
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display statistical information for categorical variables</span>
<span class="n">train</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5526</td>
      <td>5526</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>5436</td>
      <td>12</td>
    </tr>
    <tr>
      <th>top</th>
      <td>Tipster gir deg ferske oddstips hver dag!</td>
      <td>Goal/Assist</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>11</td>
      <td>1117</td>
    </tr>
  </tbody>
</table>
</div><p>There are 90 paragraphs that are not unique, with “Tipster gir deg…”
being the most frequent.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>83</th>
      <td>Se målene i Sportsnyhetene øverst!\n</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>378</th>
      <td>Se målene i Sportsnyhetene øverst!\n</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>840</th>
      <td>Tipster gir deg ferske oddstips hver dag!</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>846</th>
      <td>Tipster gir deg ferske oddstips hver dag!</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>847</th>
      <td>• Her er fredagens oddstips</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5376</th>
      <td>Se generaltabben i videovinduet øverst.</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>5383</th>
      <td>Se Leicester mot Liverpool på TV 2 Sport Premi...</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>5387</th>
      <td>Se Europaligaen på TV 2 Sumo og TV 2s kanaler!\n</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>5398</th>
      <td>VG Live: Følg Norge-Nederland kl. 17.00</td>
      <td>Ignore</td>
    </tr>
    <tr>
      <th>5400</th>
      <td>Norge-Kypros ser du på TV 2 eller følger på V...</td>
      <td>Ignore</td>
    </tr>
  </tbody>
</table>
<p>90 rows × 2 columns</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display statistical information for categorical variables</span>
<span class="n">test</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>611</td>
      <td>611</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>609</td>
      <td>5</td>
    </tr>
    <tr>
      <th>top</th>
      <td>– Selvfølgelig vil jeg tilbake til Madrid og s...</td>
      <td>Irrelevant</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>2</td>
      <td>293</td>
    </tr>
  </tbody>
</table>
</div><p>There are at least two duplicate paragraphs in the testing data</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>290</th>
      <td>– Selvfølgelig vil jeg tilbake til Madrid og s...</td>
      <td>Quote</td>
    </tr>
    <tr>
      <th>588</th>
      <td>– Jeg har mange drømmer, også her i Vitesse. Å...</td>
      <td>Quote</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display statistical information for categorical variables</span>
<span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2005</td>
      <td>2002</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>2003</td>
      <td>226</td>
    </tr>
    <tr>
      <th>top</th>
      <td>– Vi vil ikke la dem forby våre ytringer. Når ...</td>
      <td>[Storytelling]</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>2</td>
      <td>429</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1434</th>
      <td>– Vi vil ikke la dem forby våre ytringer. Når ...</td>
      <td>[Quote, Statement]</td>
    </tr>
    <tr>
      <th>1856</th>
      <td>Hugo Lloris 8</td>
      <td>[Garbage]</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Goal</span><span class="o">/</span><span class="n">Assist</span>       <span class="mi">1117</span>
<span class="n">quote</span>              <span class="mi">975</span>
<span class="n">Transfer</span>           <span class="mi">887</span>
<span class="n">irrelevant</span>         <span class="mi">812</span>
<span class="n">Ignore</span>             <span class="mi">663</span>
<span class="n">Player</span> <span class="n">details</span>     <span class="mi">340</span>
<span class="n">Club</span> <span class="n">details</span>       <span class="mi">315</span>
<span class="n">sjanse</span>             <span class="mi">300</span>
<span class="n">Injuries</span>            <span class="mi">59</span>
<span class="n">Rodt</span><span class="o">/</span><span class="n">gult</span> <span class="n">kort</span>      <span class="mi">50</span>
<span class="n">Club</span> <span class="n">drama</span>           <span class="mi">5</span>
<span class="n">Personal</span> <span class="n">drama</span>       <span class="mi">3</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">label</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Irrelevant</span>     <span class="mi">293</span>
<span class="n">Quote</span>          <span class="mi">141</span>
<span class="n">Goal</span><span class="o">/</span><span class="n">Assist</span>     <span class="mi">69</span>
<span class="n">Transfer</span>        <span class="mi">60</span>
<span class="n">Ignore</span>          <span class="mi">48</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">label</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Storytelling</span><span class="p">]</span>                       <span class="mi">429</span>
<span class="p">[</span><span class="n">Quote</span><span class="p">]</span>                              <span class="mi">178</span>
<span class="p">[</span><span class="n">Garbage</span><span class="p">]</span>                            <span class="mi">153</span>
<span class="p">[</span><span class="n">Quote</span><span class="p">,</span> <span class="n">Statement</span><span class="p">]</span>                   <span class="mi">151</span>
<span class="p">[</span><span class="n">Statement</span><span class="p">,</span> <span class="n">Storytelling</span><span class="p">]</span>             <span class="mi">69</span>
                                    <span class="o">...</span>
<span class="p">[</span><span class="n">Injury</span><span class="p">]</span>                               <span class="mi">1</span>
<span class="p">[</span><span class="n">Commentary</span><span class="p">,</span> <span class="n">Rumour</span><span class="p">,</span> <span class="n">Transfer</span><span class="p">]</span>         <span class="mi">1</span>
<span class="p">[</span><span class="n">Commentary</span><span class="p">,</span> <span class="n">Quote</span><span class="p">,</span> <span class="n">Storytelling</span><span class="p">]</span>      <span class="mi">1</span>
<span class="p">[</span><span class="n">Goal</span><span class="p">,</span> <span class="n">Storytelling</span><span class="p">,</span> <span class="n">Table</span><span class="p">]</span>            <span class="mi">1</span>
<span class="p">[</span><span class="n">Opinion</span><span class="p">,</span> <span class="n">Quote</span><span class="p">,</span> <span class="n">Transfer</span><span class="p">]</span>             <span class="mi">1</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">label</span><span class="p">,</span> <span class="n">Length</span><span class="p">:</span> <span class="mi">226</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exploded_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">label_freq</span> <span class="o">=</span> <span class="n">exploded_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">frequency</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">))</span>
<span class="n">label_freq</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>frequency</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Booking</td>
      <td>16</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Chance</td>
      <td>42</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Commentary</td>
      <td>106</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Description</td>
      <td>207</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Garbage</td>
      <td>223</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Goal</td>
      <td>169</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Injury</td>
      <td>45</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Link</td>
      <td>30</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Next game</td>
      <td>57</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Odds</td>
      <td>20</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Opinion</td>
      <td>82</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Quote</td>
      <td>448</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Rumour</td>
      <td>32</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Set-piece</td>
      <td>57</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Statement</td>
      <td>389</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Statistics</td>
      <td>60</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Storytelling</td>
      <td>874</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Substitution</td>
      <td>24</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Summary</td>
      <td>226</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Table</td>
      <td>68</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Transfer</td>
      <td>57</td>
    </tr>
    <tr>
      <th>21</th>
      <td>VAR</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></section>
<section id="data-preprocessing">
<h2>Data preprocessing<a class="headerlink" href="#data-preprocessing" title="Permalink to this heading">#</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">processed_train</span> <span class="o">=</span> <span class="n">DataPreprocessorNordskog</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">processed_train</span><span class="o">.</span><span class="n">map_nordskog_data</span><span class="p">()</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">processed_train</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">preprocessed_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">data_processor</span> <span class="o">=</span> <span class="n">DataPreprocessorHelland</span><span class="p">(</span><span class="n">preprocessed_data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
<span class="n">preprocessed_data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_processor</span><span class="o">.</span><span class="n">preprocess</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">preprocessed_data</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>premier league valgte offentliggjøre tre flytt...</td>
      <td>[Link]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>romelu lukaku uttalt misfornøyd egen situasjon...</td>
      <td>[Opinion, Statement]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>– la ærlige liker skaper støy trenger</td>
      <td>[Quote]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>manchester united fått mye kritikk karet – tab...</td>
      <td>[Commentary]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torsdagens oddstips</td>
      <td>[Garbage, Link, Odds]</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2000</th>
      <td>marko gruljic red star belgrade januar</td>
      <td>[Garbage]</td>
    </tr>
    <tr>
      <th>2001</th>
      <td>tv s fotballkommentator øyvind alsaker mener k...</td>
      <td>[Opinion, Storytelling]</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>fire beste premier league får spille champions...</td>
      <td>[Storytelling, Table]</td>
    </tr>
    <tr>
      <th>2003</th>
      <td>– virgil van dijk alisson becker mohamed salah...</td>
      <td>[Opinion, Quote, Transfer]</td>
    </tr>
    <tr>
      <th>2004</th>
      <td>januar åpner overgangsvinduet storklubbene eur...</td>
      <td>[Storytelling]</td>
    </tr>
  </tbody>
</table>
<p>2005 rows × 2 columns</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;num_char&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;num_words&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;num_sent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">sent_tokenize</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;avg_word_len&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()]))</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;avg_sent_len&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">sent_tokenize</span><span class="p">(</span><span class="n">x</span><span class="p">)]))</span>
<span class="n">train</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
      <th>num_char</th>
      <th>num_words</th>
      <th>num_sent</th>
      <th>avg_word_len</th>
      <th>avg_sent_len</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Vålerenga - Rosenborg 2-3</td>
      <td>Ignore</td>
      <td>25</td>
      <td>4</td>
      <td>1</td>
      <td>5.500000</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sam Johnson ga vertene ledelsen, men Jonathan ...</td>
      <td>Goal/Assist</td>
      <td>187</td>
      <td>31</td>
      <td>2</td>
      <td>5.064516</td>
      <td>15.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>På et hjørnespark langt på overtid kom avgjøre...</td>
      <td>Goal/Assist</td>
      <td>134</td>
      <td>20</td>
      <td>1</td>
      <td>5.750000</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ti minutter før pause scoret Sam Johnson sitt ...</td>
      <td>Goal/Assist</td>
      <td>166</td>
      <td>31</td>
      <td>1</td>
      <td>4.387097</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Vålerenga holdt 1-0-ledelsen bare frem til sis...</td>
      <td>Goal/Assist</td>
      <td>203</td>
      <td>29</td>
      <td>2</td>
      <td>6.034483</td>
      <td>14.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5521</th>
      <td>– Mateo har sagt at han ønsker å dra. Jeg vil ...</td>
      <td>Quote</td>
      <td>152</td>
      <td>29</td>
      <td>2</td>
      <td>4.275862</td>
      <td>14.5</td>
    </tr>
    <tr>
      <th>5522</th>
      <td>– Her gjør han en miss. Han står midt i mål, o...</td>
      <td>Quote</td>
      <td>242</td>
      <td>46</td>
      <td>4</td>
      <td>4.282609</td>
      <td>11.5</td>
    </tr>
    <tr>
      <th>5523</th>
      <td>– Vi kan ta med masse positivt fra kampen, for...</td>
      <td>Quote</td>
      <td>213</td>
      <td>42</td>
      <td>2</td>
      <td>4.095238</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>5524</th>
      <td>Den tyske midtbanespilleren kom til Bayern Mün...</td>
      <td>Player Detail</td>
      <td>327</td>
      <td>53</td>
      <td>2</td>
      <td>4.735849</td>
      <td>26.5</td>
    </tr>
    <tr>
      <th>5525</th>
      <td>Bendtner har vært i norsk fotball siden mars 2...</td>
      <td>Player Detail</td>
      <td>170</td>
      <td>29</td>
      <td>2</td>
      <td>4.896552</td>
      <td>14.5</td>
    </tr>
  </tbody>
</table>
<p>5526 rows × 7 columns</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;num_char&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;num_words&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;num_sent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">sent_tokenize</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;avg_word_len&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()]))</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;avg_sent_len&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">sent_tokenize</span><span class="p">(</span><span class="n">x</span><span class="p">)]))</span>
<span class="n">data</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
      <th>num_char</th>
      <th>num_words</th>
      <th>num_sent</th>
      <th>avg_word_len</th>
      <th>avg_sent_len</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Premier League valgte å offentliggjøre tre fly...</td>
      <td>[Link]</td>
      <td>25</td>
      <td>4</td>
      <td>1</td>
      <td>5.500000</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Romelu Lukaku har uttalt at han er misfornøyd ...</td>
      <td>[Opinion, Statement]</td>
      <td>187</td>
      <td>31</td>
      <td>2</td>
      <td>5.064516</td>
      <td>15.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>– La oss være ærlige. Jeg liker det ikke, for ...</td>
      <td>[Quote]</td>
      <td>134</td>
      <td>20</td>
      <td>1</td>
      <td>5.750000</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Manchester United har fått mye kritikk etter å...</td>
      <td>[Commentary]</td>
      <td>166</td>
      <td>31</td>
      <td>1</td>
      <td>4.387097</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Her er torsdagens oddstips!</td>
      <td>[Garbage, Link, Odds]</td>
      <td>203</td>
      <td>29</td>
      <td>2</td>
      <td>6.034483</td>
      <td>14.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2000</th>
      <td>Marko Gruljic fra Red Star Belgrade 6. januar ...</td>
      <td>[Garbage]</td>
      <td>61</td>
      <td>9</td>
      <td>1</td>
      <td>5.888889</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>2001</th>
      <td>TV 2s fotballkommentator Øyvind Alsaker mener ...</td>
      <td>[Opinion, Storytelling]</td>
      <td>258</td>
      <td>44</td>
      <td>2</td>
      <td>4.886364</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>De fire beste i Premier League får spille i Ch...</td>
      <td>[Storytelling, Table]</td>
      <td>168</td>
      <td>26</td>
      <td>1</td>
      <td>5.461538</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>2003</th>
      <td>– Virgil van Dijk, Alisson Becker og Mohamed S...</td>
      <td>[Opinion, Quote, Transfer]</td>
      <td>203</td>
      <td>36</td>
      <td>2</td>
      <td>4.666667</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>2004</th>
      <td>1. januar åpner overgangsvinduet, og storklubb...</td>
      <td>[Storytelling]</td>
      <td>209</td>
      <td>37</td>
      <td>2</td>
      <td>4.675676</td>
      <td>18.5</td>
    </tr>
  </tbody>
</table>
<p>2005 rows × 7 columns</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">)),</span>
             <span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span>
             <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Labels&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="s1">&#39;Amount of paragraphs&#39;</span><span class="p">},</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sum of paragraphs per label in training data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/output_27_1.png" src="_images/output_27_1.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multi_label_string</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">multi_label_string</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multi_label_string</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">)</span>
<span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">multi_label_string</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">)),</span>
             <span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span>
             <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Labels&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="s1">&#39;Amount of paragraphs&#39;</span><span class="p">},</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sum of paragraphs per label set in multi-label data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/output_28_0.png" src="_images/output_28_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">label_freq</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="nb">sum</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">)),</span>
             <span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span>
             <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Labels&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">:</span> <span class="s1">&#39;Amount of paragraphs&#39;</span><span class="p">},</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sum of paragraphs per label in multi-label data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/output_29_01.png" src="_images/output_29_01.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">sum_words</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;num_words&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">)),</span>
             <span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sum_words&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span>
             <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Labels&#39;</span><span class="p">,</span> <span class="s1">&#39;sum_words&#39;</span><span class="p">:</span> <span class="s1">&#39;Amount of words&#39;</span><span class="p">},</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sum of words per label in training data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/output_30_0.png" src="_images/output_30_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exploded_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">exploded_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">sum_words</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;num_words&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">)),</span>
             <span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sum_words&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span>
             <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Labels&#39;</span><span class="p">,</span> <span class="s1">&#39;sum_words&#39;</span><span class="p">:</span> <span class="s1">&#39;Amount of words&#39;</span><span class="p">},</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sum of words per label in multi-label data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/output_31_0.png" src="_images/output_31_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">sum_char</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;num_char&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">)),</span>
             <span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sum_char&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span>
             <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Labels&#39;</span><span class="p">,</span> <span class="s1">&#39;sum_char&#39;</span><span class="p">:</span> <span class="s1">&#39;Amount of characters&#39;</span><span class="p">},</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sum of characters per label in training data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/output_32_0.png" src="_images/output_32_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exploded_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">exploded_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">sum_char</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;num_char&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">)),</span>
             <span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sum_char&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span>
             <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Labels&#39;</span><span class="p">,</span> <span class="s1">&#39;sum_char&#39;</span><span class="p">:</span> <span class="s1">&#39;Amount of characters&#39;</span><span class="p">},</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sum of characters per label in multi-label data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/output_33_0.png" src="_images/output_33_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">sum_sent</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;num_sent&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">)),</span>
             <span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sum_sent&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span>
             <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Labels&#39;</span><span class="p">,</span> <span class="s1">&#39;sum_sent&#39;</span><span class="p">:</span> <span class="s1">&#39;Amount of characters&#39;</span><span class="p">},</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sum of sentences per label in training data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/output_34_0.png" src="_images/output_34_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exploded_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">exploded_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">sum_sent</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;num_sent&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">)),</span>
             <span class="n">x</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sum_sent&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span>
             <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Labels&#39;</span><span class="p">,</span> <span class="s1">&#39;sum_sent&#39;</span><span class="p">:</span> <span class="s1">&#39;Amount of characters&#39;</span><span class="p">},</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sum of sentences per label in multi-label data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/output_35_0.png" src="_images/output_35_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plots</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

<span class="k">for</span> <span class="n">plot</span> <span class="ow">in</span> <span class="n">plots</span><span class="p">:</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">create_distplot</span><span class="p">([</span><span class="n">train</span><span class="p">[</span><span class="n">plot</span><span class="p">]],</span> <span class="p">[</span><span class="n">plot</span><span class="p">],</span> <span class="n">curve_type</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Training data - &#39;</span> <span class="o">+</span> <span class="n">plot</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/output_36_0.png" src="_images/output_36_0.png" />
<img alt="_images/output_36_1.png" src="_images/output_36_1.png" />
<img alt="_images/output_36_2.png" src="_images/output_36_2.png" />
<img alt="_images/output_36_3.png" src="_images/output_36_3.png" />
<img alt="_images/output_36_4.png" src="_images/output_36_4.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plots</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

<span class="k">for</span> <span class="n">plot</span> <span class="ow">in</span> <span class="n">plots</span><span class="p">:</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">create_distplot</span><span class="p">([</span><span class="n">train</span><span class="p">[</span><span class="n">plot</span><span class="p">]],</span> <span class="p">[</span><span class="n">plot</span><span class="p">],</span> <span class="n">curve_type</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Multi-label data - &#39;</span> <span class="o">+</span> <span class="n">plot</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/output_37_0.png" src="_images/output_37_0.png" />
<img alt="_images/output_37_1.png" src="_images/output_37_1.png" />
<img alt="_images/output_37_2.png" src="_images/output_37_2.png" />
<img alt="_images/output_37_3.png" src="_images/output_37_3.png" />
<img alt="_images/output_37_4.png" src="_images/output_37_4.png" />
<section id="nordskog-data">
<h3>Nordskog data<a class="headerlink" href="#nordskog-data" title="Permalink to this heading">#</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">processed_train</span><span class="o">.</span><span class="n">remove_extra_spaces_from_text</span><span class="p">()</span>
<span class="n">processed_train</span><span class="o">.</span><span class="n">remove_paragraphs_over_65_words</span><span class="p">()</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">processed_train</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;norwegian&#39;</span><span class="p">))</span>
<span class="n">corpus</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">i</span> <span class="k">if</span> <span class="p">(</span><span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stop</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">most_frequent</span> <span class="o">=</span> <span class="n">FreqDist</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">most_frequent</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;–&#39;</span><span class="p">,</span> <span class="mi">1173</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;Det&#39;</span><span class="p">,</span> <span class="mi">830</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;fikk&#39;</span><span class="p">,</span> <span class="mi">496</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;ballen&#39;</span><span class="p">,</span> <span class="mi">476</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;minutter&#39;</span><span class="p">,</span> <span class="mi">469</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;sier&#39;</span><span class="p">,</span> <span class="mi">434</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;TV&#39;</span><span class="p">,</span> <span class="mi">423</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;Han&#39;</span><span class="p">,</span> <span class="mi">395</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;første&#39;</span><span class="p">,</span> <span class="mi">391</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="mi">377</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">words</span><span class="p">,</span> <span class="n">frequency</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">most_frequent</span><span class="p">:</span>
    <span class="n">words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="n">frequency</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">frequency</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">words</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">autorange</span><span class="o">=</span><span class="s2">&quot;reversed&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/output_42_0.png" src="_images/output_42_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vec</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">bow</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
<span class="n">count_values</span> <span class="o">=</span> <span class="n">bow</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ngram_freq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">sorted</span><span class="p">([(</span><span class="n">count_values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vec</span><span class="o">.</span><span class="n">vocabulary_</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span> <span class="n">reverse</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<span class="n">ngram_freq</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;frequency&quot;</span><span class="p">,</span> <span class="s2">&quot;ngram&quot;</span><span class="p">]</span>
<span class="n">ngram_freq</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>frequency</th>
      <th>ngram</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>415</td>
      <td>det er</td>
    </tr>
    <tr>
      <th>1</th>
      <td>267</td>
      <td>det var</td>
    </tr>
    <tr>
      <th>2</th>
      <td>236</td>
      <td>premier league</td>
    </tr>
    <tr>
      <th>3</th>
      <td>204</td>
      <td>at han</td>
    </tr>
    <tr>
      <th>4</th>
      <td>159</td>
      <td>var det</td>
    </tr>
    <tr>
      <th>5</th>
      <td>159</td>
      <td>på tv</td>
    </tr>
    <tr>
      <th>6</th>
      <td>153</td>
      <td>manchester united</td>
    </tr>
    <tr>
      <th>7</th>
      <td>143</td>
      <td>da han</td>
    </tr>
    <tr>
      <th>8</th>
      <td>142</td>
      <td>real madrid</td>
    </tr>
    <tr>
      <th>9</th>
      <td>138</td>
      <td>han har</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vec</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">bow</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
<span class="n">count_values</span> <span class="o">=</span> <span class="n">bow</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ngram_freq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">sorted</span><span class="p">([(</span><span class="n">count_values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vec</span><span class="o">.</span><span class="n">vocabulary_</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span> <span class="n">reverse</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<span class="n">ngram_freq</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;frequency&quot;</span><span class="p">,</span> <span class="s2">&quot;ngram&quot;</span><span class="p">]</span>
<span class="n">ngram_freq</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>frequency</th>
      <th>ngram</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>77</td>
      <td>tv sport premium</td>
    </tr>
    <tr>
      <th>1</th>
      <td>60</td>
      <td>på tv sport</td>
    </tr>
    <tr>
      <th>2</th>
      <td>46</td>
      <td>det er en</td>
    </tr>
    <tr>
      <th>3</th>
      <td>41</td>
      <td>sport premium og</td>
    </tr>
    <tr>
      <th>4</th>
      <td>41</td>
      <td>det er ikke</td>
    </tr>
    <tr>
      <th>5</th>
      <td>37</td>
      <td>minutter før slutt</td>
    </tr>
    <tr>
      <th>6</th>
      <td>36</td>
      <td>men det er</td>
    </tr>
    <tr>
      <th>7</th>
      <td>36</td>
      <td>han er en</td>
    </tr>
    <tr>
      <th>8</th>
      <td>36</td>
      <td>det var en</td>
    </tr>
    <tr>
      <th>9</th>
      <td>35</td>
      <td>før full tid</td>
    </tr>
  </tbody>
</table>
</div></section>
<section id="multi-label-data">
<h3>Multi-label data<a class="headerlink" href="#multi-label-data" title="Permalink to this heading">#</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;norwegian&#39;</span><span class="p">))</span>
<span class="n">corpus</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">preprocessed_data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">i</span> <span class="k">if</span> <span class="p">(</span><span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stop</span><span class="p">)]</span>
<span class="n">most_frequent</span> <span class="o">=</span> <span class="n">FreqDist</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">most_frequent</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;–&#39;</span><span class="p">,</span> <span class="mi">999</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;vg&#39;</span><span class="p">,</span> <span class="mi">220</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;sier&#39;</span><span class="p">,</span> <span class="mi">211</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;manchester&#39;</span><span class="p">,</span> <span class="mi">184</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;vm&#39;</span><span class="p">,</span> <span class="mi">166</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;league&#39;</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="mi">129</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;kampen&#39;</span><span class="p">,</span> <span class="mi">122</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;første&#39;</span><span class="p">,</span> <span class="mi">115</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;år&#39;</span><span class="p">,</span> <span class="mi">112</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">words</span><span class="p">,</span> <span class="n">frequency</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">most_frequent</span><span class="p">:</span>
    <span class="n">words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="n">frequency</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">frequency</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">words</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">autorange</span><span class="o">=</span><span class="s2">&quot;reversed&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/output_47_0.png" src="_images/output_47_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vec</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">bow</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">preprocessed_data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
<span class="n">count_values</span> <span class="o">=</span> <span class="n">bow</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ngram_freq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">sorted</span><span class="p">([(</span><span class="n">count_values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vec</span><span class="o">.</span><span class="n">vocabulary_</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span> <span class="n">reverse</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<span class="n">ngram_freq</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;frequency&quot;</span><span class="p">,</span> <span class="s2">&quot;ngram&quot;</span><span class="p">]</span>
<span class="n">ngram_freq</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>frequency</th>
      <th>ngram</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>80</td>
      <td>manchester united</td>
    </tr>
    <tr>
      <th>1</th>
      <td>77</td>
      <td>bodø glimt</td>
    </tr>
    <tr>
      <th>2</th>
      <td>71</td>
      <td>manchester city</td>
    </tr>
    <tr>
      <th>3</th>
      <td>64</td>
      <td>premier league</td>
    </tr>
    <tr>
      <th>4</th>
      <td>55</td>
      <td>erling braut</td>
    </tr>
    <tr>
      <th>5</th>
      <td>53</td>
      <td>braut haaland</td>
    </tr>
    <tr>
      <th>6</th>
      <td>49</td>
      <td>champions league</td>
    </tr>
    <tr>
      <th>7</th>
      <td>35</td>
      <td>real madrid</td>
    </tr>
    <tr>
      <th>8</th>
      <td>24</td>
      <td>første gang</td>
    </tr>
    <tr>
      <th>9</th>
      <td>22</td>
      <td>ullevaal stadion</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vec</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">bow</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">preprocessed_data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
<span class="n">count_values</span> <span class="o">=</span> <span class="n">bow</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ngram_freq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">sorted</span><span class="p">([(</span><span class="n">count_values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vec</span><span class="o">.</span><span class="n">vocabulary_</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span> <span class="n">reverse</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<span class="n">ngram_freq</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;frequency&quot;</span><span class="p">,</span> <span class="s2">&quot;ngram&quot;</span><span class="p">]</span>
<span class="n">ngram_freq</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>frequency</th>
      <th>ngram</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>52</td>
      <td>erling braut haaland</td>
    </tr>
    <tr>
      <th>1</th>
      <td>17</td>
      <td>ullevaal stadion vg</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11</td>
      <td>trener kjetil knutsen</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9</td>
      <td>vg bodø glimt</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>glimt trener kjetil</td>
    </tr>
    <tr>
      <th>5</th>
      <td>9</td>
      <td>erik ten hag</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8</td>
      <td>john arne riise</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>vg erling braut</td>
    </tr>
    <tr>
      <th>8</th>
      <td>6</td>
      <td>nils arne eggen</td>
    </tr>
    <tr>
      <th>9</th>
      <td>6</td>
      <td>lillestrøm vg lillestrøm</td>
    </tr>
  </tbody>
</table>
</div></section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="clustering.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Clustering</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="eda.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">EDA</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Eirik Helland
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">EDA v2</a><ul>
<li><a class="reference internal" href="#imports">Imports</a></li>
<li><a class="reference internal" href="#loading-data">Loading data</a></li>
<li><a class="reference internal" href="#about-the-data">About the data</a></li>
<li><a class="reference internal" href="#data-preprocessing">Data preprocessing</a><ul>
<li><a class="reference internal" href="#nordskog-data">Nordskog data</a></li>
<li><a class="reference internal" href="#multi-label-data">Multi-label data</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    </body>
</html>